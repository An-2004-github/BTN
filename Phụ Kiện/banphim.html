<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bàn phím cơ, Gaming, Văn phòng | Chính hãng</title>
    
    <link rel="stylesheet" href="..\style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <script>
        fetch('../header.html')
        .then(res => res.text())
        .then(data => document.getElementById('header').innerHTML = data);
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <div id = 'header'></div>
    <div class="container my-3">
        <div class="container my-3 d-flex flex-wrap justify-content-start align-items-center gap-3 brand-container"> 
            <a href="#" class="brand-btn" data-brand="Logitech">
                <img src="../Images/Logo hãng/logitech_g-logo_brandlogos.net_tzeki.png" alt="Logitech" style="max-height: 35px;"/>
            </a>
            <a href="#" class="brand-btn" data-brand="Corsair">
                <img src="../Images/Logo hãng/corsair-2-logo-black-and-white.png" alt="Corsair" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="Razer">
                <img src="../Images/Logo hãng/razer.png" alt="Razer" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="Keychron">
                <img src="../Images/Logo hãng/Keychron-logo-1_1659168402.png" alt="Keychron" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="Akko">
                <img src="../Images/Logo hãng/logoakko.png" alt="Akko" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="SteelSeries">
                <img src="../Images/Logo hãng/logo_Steelseries.png" alt="Steelseries" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="DareU">
                <img src="../Images/Logo hãng/Dareu.png" alt="Dareu" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="Fuhlen">
                <img src="../Images/Logo hãng/fuhlen.webp" alt="fuhlen" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="Apple">
                <img src="../Images/Logo hãng/apple.png" alt="apple" style="max-height: 35px;" />
            </a>
            <a href="#" class="brand-btn" data-brand="Asus">
                <img src="../Images/Logo hãng/asus.png" alt="asus" style="max-height: 35px;" />
            </a>
        </div>
    </div>

    <div class="container p-3 bg-light rounded shadow-sm">
        <form id="filterForm">
            <div class="form-row">
                <div class="form-group col-md-2">
                    <label for="brandSelect">Thương hiệu</label>
                    <select id="brandSelect" class="form-control form-control-sm">
                        <option value="Tất cả">Tất cả</option>
                        </select>
                </div>
                <div class="form-group col-md-2">
                    <label for="priceSelect">Mức giá</label>
                    <select id="priceSelect" class="form-control form-control-sm">
                        <option value="Tất cả">Tất cả</option>
                        <option value="Dưới 1 triệu">Dưới 1 triệu</option>
                        <option value="1 - 2 triệu">1 - 2 triệu</option>
                        <option value="2 - 4 triệu">2 - 4 triệu</option>
                        <option value="Trên 4 triệu">Trên 4 triệu</option>
                    </select>
                </div>
                <div class="form-group col-md-2">
                    <label for="typeSelect">Loại bàn phím</label>
                    <select id="typeSelect" class="form-control form-control-sm">
                        <option value="Tất cả">Tất cả</option>
                        <option>Cơ</option>
                        <option>Giả cơ</option>
                        <option>Văn phòng</option>
                    </select>
                </div>
                <div class="form-group col-md-2">
                    <label for="switchSelect">Loại Switch</label>
                    <select id="switchSelect" class="form-control form-control-sm">
                        <option value="Tất cả">Tất cả</option>
                        <option>Blue Switch</option>
                        <option>Red Switch</option>
                        <option>Brown Switch</option>
                        <option>Khác</option>
                    </select>
                </div>
                <div class="form-group col-md-2">
                    <label for="layoutSelect">Layout</label>
                    <select id="layoutSelect" class="form-control form-control-sm">
                        <option value="Tất cả">Tất cả</option>
                        <option>Full-size</option>
                        <option>TKL</option>
                        <option>75%</option>
                        <option>60%</option>
                    </select>
                </div>
                <div class="form-group col-md-2">
                    <label for="connectSelect">Kết nối</label>
                    <select id="connectSelect" class="form-control form-control-sm">
                        <option value="Tất cả">Tất cả</option>
                        <option>Có dây</option>
                        <option>Không dây (Wireless)</option>
                        <option>Bluetooth</option>
                    </select>
                </div>
                   <div class="form-group col-md-2">
                        <label for="ledSelect">Đèn LED</label>
                        <select id="ledSelect" class="form-control form-control-sm">
                            <option value="Tất cả">Tất cả</option>
                            <option>RGB</option>
                            <option>Đơn sắc</option>
                            <option>Không LED</option>
                        </select>
                    </div>
            </div>
            <div class="form-row">
                <div class="form-group col-12 text-right">
                    <button type="submit" class="btn btn-warning btn-sm">LỌC KẾT QUẢ</button>
                </div>
            </div>
        </form>
    </div>

    <div class="container my-3">
        <div class="row" id="product-list">
            </div>
    </div>
    
    <div id="toast" style="visibility: hidden; min-width: 250px; background-color: #4CAF50; color: white; text-align: center; border-radius: 8px; padding: 16px; position: fixed; z-index: 1000; left: 50%; top: 50%; transform: translate(-50%, -50%); font-size: 17px; opacity: 0; transition: opacity 0.5s ease-in-out;">
    </div>

    <div id="footer"></div>


    <script>
    // Dữ liệu sản phẩm bàn phím
    const products = [
        {
            id: 1,
            name: "Logitech G Pro X TKL Lightspeed",
            image: "../Images/BanPhim/logitech_pro_x_tkl_lightspeed.jpg",
            brand: "Logitech",
            type: "Cơ",
            switchType: "Blue Switch",
            layout: "TKL",
            connect: ["Không dây (Wireless)"],
            led: "RGB",
            priceOld: 4190000,
            discountPercent: 12,
        },
        {
            id: 2,
            name: "Corsair K70 RGB MK.2",
            image: "../Images/BanPhim/Corsair K70 RGB MK.2.jpg",
            brand: "Corsair",
            type: "Cơ",
            switchType: "Red Switch",
            layout: "Full-size",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 3890000,
            discountPercent: 15,
        },
        {
            id: 3,
            name: "Razer BlackWidow V4",
            image: "../Images/BanPhim/Razer BlackWidow V4.jpg",
            brand: "Razer",
            type: "Cơ",
            switchType: "Green Switch",
            layout: "Full-size",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 3200000,
            discountPercent: 10,
        },
        {
            id: 4,
            name: "Keychron K8 Pro",
            image: "../Images/BanPhim/Keychron K8 Pro.jpg",
            brand: "Keychron",
            type: "Cơ",
            switchType: "Brown Switch",
            layout: "TKL",
            connect: ["Có dây", "Bluetooth"],
            led: "Đơn sắc",
            priceOld: 2590000,
            discountPercent: 5,
        },
        {
            id: 5,
            name: "Akko 3087 v2 World Tour Tokyo",
            image: "../Images/BanPhim/Akko 3087 v2 World Tour Tokyo.jpg",
            brand: "Akko",
            type: "Cơ",
            switchType: "Red Switch",
            layout: "TKL",
            connect: ["Có dây"],
            led: "Không LED",
            priceOld: 1850000,
            discountPercent: 8,
        },
        {
            id: 6,
            name: "Logitech K120",
            image: "../Images/BanPhim/Logitech K120.jpg",
            brand: "Logitech",
            type: "Văn phòng",
            switchType: "Khác",
            layout: "Full-size",
            connect: ["Có dây"],
            led: "Không LED",
            priceOld: 250000,
            discountPercent: 20,
        },
        {
            id: 7,
            name: "Razer Huntsman Mini",
            image: "../Images/BanPhim/Razer Huntsman Mini.jpg",
            brand: "Razer",
            type: "Cơ",
            switchType: "Razer Optical Red",
            layout: "60%",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 3100000,
            discountPercent: 15,
        },
        {
            id: 8,
            name: "SteelSeries Apex Pro TKL",
            image: "../Images/BanPhim/SteelSeries Apex Pro TKL.jpg",
            brand: "SteelSeries",
            type: "Cơ",
            switchType: "OmniPoint",
            layout: "TKL",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 5200000,
            discountPercent: 10,
        },
        {
            id: 9,
            name: "Corsair K100 AIR Wireless",
            image: "../Images/BanPhim/Corsair K100 AIR Wireless.jpg",
            brand: "Corsair",
            type: "Cơ",
            switchType: "Cherry MX Ultra Low Profile",
            layout: "Full-size",
            connect: ["Không dây (Wireless)", "Bluetooth"],
            led: "RGB",
            priceOld: 7500000,
            discountPercent: 8,
        },
        {
            id: 10,
            name: "Akko 5075S Dracula Castle",
            image: "../Images/BanPhim/Akko 5075S Dracula Castle.jpg",
            brand: "Akko",
            type: "Cơ",
            switchType: "Akko CS Switch",
            layout: "75%",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 2350000,
            discountPercent: 18,
        },
        {
            id: 11,
            name: "Logitech MX Keys S",
            image: "../Images/BanPhim/Logitech MX Keys S.jpg",
            brand: "Logitech",
            type: "Văn phòng",
            switchType: "Khác",
            layout: "Full-size",
            connect: ["Không dây (Wireless)", "Bluetooth"],
            led: "Đơn sắc",
            priceOld: 2890000,
            discountPercent: 10,
        },
        {
            id: 12,
            name: "Keychron Q1 Pro",
            image: "../Images/BanPhim/Keychron Q1 Pro.jpg",
            brand: "Keychron",
            type: "Cơ",
            switchType: "Brown Switch",
            layout: "75%",
            connect: ["Không dây (Wireless)", "Bluetooth"],
            led: "RGB",
            priceOld: 4990000,
            discountPercent: 12,
        },
        {
            id: 13,
            name: "DareU EK87 Queen",
            image: "../Images/BanPhim/DareU EK87 Queen.jpg",
            brand: "DareU",
            type: "Giả cơ",
            switchType: "Khác",
            layout: "TKL",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 690000,
            discountPercent: 25,
        },
        {
            id: 14,
            name: "Razer Ornata V3",
            image: "../Images/BanPhim/Razer Ornata V3.webp",
            brand: "Razer",
            type: "Giả cơ",
            switchType: "Razer Mecha-Membrane",
            layout: "Full-size",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 1990000,
            discountPercent: 20,
        },
        {
            id: 15,
            name: "Fuhlen L411",
            image: "../Images/BanPhim/Fuhlen L411.jpg",
            brand: "Fuhlen",
            type: "Văn phòng",
            switchType: "Khác",
            layout: "Full-size",
            connect: ["Có dây"],
            led: "Không LED",
            priceOld: 220000,
            discountPercent: 15,
        },
        {
            id: 16,
            name: "Logitech G913 TKL Lightspeed",
            image: "../Images/BanPhim/Logitech G913 TKL Lightspeed.webp",
            brand: "Logitech",
            type: "Cơ",
            switchType: "GL Tactile",
            layout: "TKL",
            connect: ["Không dây (Wireless)", "Bluetooth"],
            led: "RGB",
            priceOld: 4790000,
            discountPercent: 15,
        },
        {
            id: 17,
            name: "E-Dra EK387",
            image: "../Images/BanPhim/E-Dra EK387.jpg",
            brand: "E-Dra",
            type: "Cơ",
            switchType: "Blue Switch",
            layout: "TKL",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 950000,
            discountPercent: 22,
        },
        {
            id: 18,
            name: "Apple Magic Keyboard",
            image: "../Images/BanPhim/Apple Magic Keyboard.webp",
            brand: "Apple",
            type: "Văn phòng",
            switchType: "Khác",
            layout: "75%",
            connect: ["Bluetooth"],
            led: "Không LED",
            priceOld: 2790000,
            discountPercent: 5,
        },
        {
            id: 19,
            name: "Asus ROG Strix Flare II Animate",
            image: "../Images/BanPhim/Asus ROG Strix Flare II Animate.png",
            brand: "Asus",
            type: "Cơ",
            switchType: "Red Switch",
            layout: "Full-size",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 5490000,
            discountPercent: 10,
        },
        {
            id: 20,
            name: "HyperX Alloy Origins 60",
            image: "../Images/BanPhim/HyperX Alloy Origins 60.webp",
            brand: "HyperX",
            type: "Cơ",
            switchType: "HyperX Red",
            layout: "60%",
            connect: ["Có dây"],
            led: "RGB",
            priceOld: 2590000,
            discountPercent: 17,
        }
    ];

    // Các hàm tiện ích
    function calcPriceNew(priceOld, discountPercent) {
        return priceOld * (1 - discountPercent / 100);
    }

    function formatPrice(price) {
        return price.toLocaleString("vi-VN") + " ₫";
    }

    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.style.visibility = 'visible';
        toast.style.opacity = '1';
        
        setTimeout(() => {
            toast.style.opacity = '0';
            setTimeout(() => {
                toast.style.visibility = 'hidden';
            }, 500);
        }, 2000);
    }

    // Logic hiển thị sản phẩm
    function displayProducts(list) {
        const productList = document.getElementById("product-list");
        productList.innerHTML = "";

        if (list.length === 0) {
            productList.innerHTML = `<div class="col-12"><p class="text-center">Không tìm thấy sản phẩm phù hợp.</p></div>`;
            return;
        }

        list.forEach(product => {
            const col = document.createElement("div");
            col.className = "col-md-3 mb-4";

            const priceNew = calcPriceNew(product.priceOld, product.discountPercent);

            col.innerHTML = `
            <div class="product-card d-flex flex-column h-100">
                <img src="${product.image}" alt="${product.name}" class="img-fluid" style="height: 200px; object-fit: contain; background: white; border-radius: 6px; padding: 10px;" />
                <h5 class="mt-2">${product.name}</h5>
                <p>Loại: ${product.type}</p>
                <p>Layout: ${product.layout}</p>
                <div>
                    <span class="price-old">${formatPrice(product.priceOld)}</span>
                    <span class="discount">-${product.discountPercent}%</span>
                </div>
                <h4 id="product-price-${product.id}">${formatPrice(priceNew)}</h4>
                <button class="add-cart btn btn-danger mt-auto">Thêm vào giỏ hàng</button>
            </div>
            `;

            productList.appendChild(col);

            // Gán sự kiện click cho nút "Thêm vào giỏ hàng"
            const addCartBtn = col.querySelector('.add-cart');
            addCartBtn.addEventListener('click', () => {
                showToast(`Đã thêm "${product.name}" vào giỏ!`);
            });
        });
    }
    
    // **MỚI: Điền các tùy chọn thương hiệu vào select box**
    function populateBrandSelect() {
        const brandSelect = document.getElementById('brandSelect');
        const brands = new Set(); // Sử dụng Set để lưu trữ các thương hiệu duy nhất

        products.forEach(product => {
            if (product.brand) { // Đảm bảo sản phẩm có thuộc tính brand
                brands.add(product.brand);
            }
        });

        // Thêm các option vào select box
        brands.forEach(brand => {
            const option = document.createElement('option');
            option.value = brand;
            option.textContent = brand;
            brandSelect.appendChild(option);
        });
    }

    // Gọi hàm này khi trang được tải
    document.addEventListener('DOMContentLoaded', populateBrandSelect);


    // Hợp nhất logic lọc form
    document.getElementById('filterForm').addEventListener('submit', e => {
        e.preventDefault();

        // Lấy giá trị từ các select
        const brandValue = document.getElementById('brandSelect').value;
        const priceValue = document.getElementById('priceSelect').value;
        const typeValue = document.getElementById('typeSelect').value;
        const switchValue = document.getElementById('switchSelect').value;
        const layoutValue = document.getElementById('layoutSelect').value;
        const connectValue = document.getElementById('connectSelect').value;
        const ledValue = document.getElementById('ledSelect').value;

        const filtered = products.filter(product => {
            const priceNew = calcPriceNew(product.priceOld, product.discountPercent);
            
            // Lọc thương hiệu
            const brandOk = brandValue === 'Tất cả' || product.brand === brandValue;

            // Lọc giá
            let priceOk = true;
            if (priceValue === 'Dưới 1 triệu') priceOk = priceNew < 1000000;
            else if (priceValue === '1 - 2 triệu') priceOk = priceNew >= 1000000 && priceNew <= 2000000;
            else if (priceValue === '2 - 4 triệu') priceOk = priceNew > 2000000 && priceNew <= 4000000;
            else if (priceValue === 'Trên 4 triệu') priceOk = priceNew > 4000000;
            
            // Lọc loại bàn phím
            const typeOk = typeValue === 'Tất cả' || product.type === typeValue;

            // Lọc Switch
            const switchOk = switchValue === 'Tất cả' || product.switchType === switchValue || (switchValue === 'Khác' && !['Blue Switch', 'Red Switch', 'Brown Switch'].includes(product.switchType));

            // Lọc Layout
            const layoutOk = layoutValue === 'Tất cả' || product.layout === layoutValue;

            // Lọc kết nối (vì 'connect' là mảng, ta dùng .includes)
            const connectOk = connectValue === 'Tất cả' || product.connect.includes(connectValue);
            
            // Lọc LED
            const ledOk = ledValue === 'Tất cả' || product.led === ledValue;

            return brandOk && priceOk && typeOk && switchOk && layoutOk && connectOk && ledOk;
        });

        displayProducts(filtered);
    });


    // Hợp nhất logic hiển thị sản phẩm khi click vào logo
    document.querySelectorAll('.brand-btn').forEach(button => {
        button.addEventListener('click', function(e) {
            e.preventDefault(); 
            const brand = this.dataset.brand;

            // Reset tất cả các select của form lọc về "Tất cả"
            document.getElementById('brandSelect').value = 'Tất cả'; // Đặt lại select thương hiệu của form
            document.getElementById('priceSelect').value = 'Tất cả';
            document.getElementById('typeSelect').value = 'Tất cả';
            document.getElementById('switchSelect').value = 'Tất cả';
            document.getElementById('layoutSelect').value = 'Tất cả';
            document.getElementById('connectSelect').value = 'Tất cả';
            document.getElementById('ledSelect').value = 'Tất cả';

            // Áp dụng bộ lọc thương hiệu
            if (brand === 'all') { 
                displayProducts(products);
            } else {
                // Cập nhật giá trị của select thương hiệu trong form lọc
                // để người dùng thấy bộ lọc đang được áp dụng
                document.getElementById('brandSelect').value = brand;

                const filteredByBrand = products.filter(product => product.brand === brand);
                displayProducts(filteredByBrand);
            }
        });
    });

    // Hiển thị tất cả sản phẩm ban đầu
    displayProducts(products);
    </script>
    <script>
        fetch('../footer.html')
        .then(res => res.text())
        .then(data => document.getElementById('footer').innerHTML = data);
    </script>
</body>
</html>