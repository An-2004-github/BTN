<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Laptop Asus - Tech Store</title>
    <link rel="stylesheet" href="../style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <!-- Bootstrap 4 CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
  </head>
  <body>
    <div id="header"></div>
    <!-- jQuery, Popper.js, Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <div class="container my-3 text-center">
      <h1 class="display-4 text-danger font-weight-bold">
        <img
          src="../Images/Logo hãng/asus.png"
          alt="Asus Logo"
          style="width: 200px; height: 70px"
        />
      </h1>
    </div>

    <!-- Thanh bộ lọc nâng cao -->
    <div class="container p-3 bg-light rounded shadow-sm">
      <form>
        <!-- Hàng trên: 6 mục -->
        <div class="form-row mb-2">
          <div class="form-group col-md-2">
            <label for="priceSelect">Mức giá</label>
            <select id="priceSelect" class="form-control form-control-sm">
              <option>Chọn mức giá</option>
              <option>Giá tăng dần</option>
              <option>Giá giảm dần</option>
              <option>Dưới 10 triệu</option>
              <option>Từ 10 - 15 triệu</option>
              <option>Từ 15 - 20 triệu</option>
              <option>Từ 20 - 25 triệu</option>
              <option>Từ 25 - 35 triệu</option>
              <option>Từ 35 - 50 triệu</option>
              <option>Trên 50 triệu</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="osSelect">Hệ điều hành</label>
            <select id="osSelect" class="form-control form-control-sm">
              <option>Chọn hệ điều hành</option>
              <option>Windows</option>
              <option>Linux</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="cpuSelect">CPU</label>
            <select id="cpuSelect" class="form-control form-control-sm">
              <option>Chọn CPU</option>
              <option>Intel Core i3</option>
              <option>Intel Core i5</option>
              <option>Intel Core i7</option>
              <option>Intel Core i9</option>
              <option>AMD Ryzen 3</option>
              <option>AMD Ryzen 5</option>
              <option>AMD Ryzen 7</option>
              <option>AMD Ryzen 9</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="ramSelect">RAM</label>
            <select id="ramSelect" class="form-control form-control-sm">
              <option>Chọn RAM</option>
              <option>4GB</option>
              <option>8GB</option>
              <option>16GB</option>
              <option>32GB</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="storageSelect">Ổ cứng</label>
            <select id="storageSelect" class="form-control form-control-sm">
              <option>Chọn ổ cứng</option>
              <option>SSD 256GB</option>
              <option>SSD 512GB</option>
              <option>SSD 1TB</option>
              <option>SSD 2TB</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="gpuSelect">Card đồ họa</label>
            <select id="gpuSelect" class="form-control form-control-sm">
              <option>Chọn card đồ họa</option>
              <option>Intel HD Graphics</option>
              <option>Intel Iris Xe</option>
              <option>NVIDIA GeForce RTX</option>
              <option>NVIDIA GeForce GTX</option>
              <option>AMD Radeon</option>
            </select>
          </div>
        </div>

        <!-- Hàng dưới: 4 mục + nút lọc -->
        <div class="form-row align-items-end">
          <div class="form-group col-md-2">
            <label for="screenSizeSelect">Kích thước màn hình</label>
            <select id="screenSizeSelect" class="form-control form-control-sm">
              <option>Chọn kích thước</option>
              <option>Dưới 13 inch</option>
              <option>13-14 inch</option>
              <option>15-16 inch</option>
              <option>Trên 16 inch</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="resolutionSelect">Độ phân giải</label>
            <select id="resolutionSelect" class="form-control form-control-sm">
              <option>Chọn độ phân giải</option>
              <option>HD</option>
              <option>Full HD</option>
              <option>2K</option>
              <option>4K</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="refreshRateSelect">Tần số quét</label>
            <select id="refreshRateSelect" class="form-control form-control-sm">
              <option>Chọn tần số quét</option>
              <option>60 Hz</option>
              <option>90 Hz</option>
              <option>120 Hz</option>
              <option>144 Hz</option>
              <option>165 Hz</option>
              <option>240 Hz</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <label for="purposeSelect">Mục đích sử dụng</label>
            <select id="purposeSelect" class="form-control form-control-sm">
              <option>Chọn mục đích</option>
              <option>Gaming</option>
              <option>Đồ họa - Kỹ thuật</option>
              <option>Học tập - Văn phòng</option>
              <option>Mỏng nhẹ - Di động</option>
            </select>
          </div>
          <div class="form-group col-md-2">
            <button type="submit" class="btn btn-warning btn-sm btn-block">
              LỌC
            </button>
          </div>
        </div>
      </form>
    </div>

    <!-- Khung danh sách sản phẩm -->
    <div class="container my-3">
      <div class="row" id="product-list">
        <!-- Sản phẩm tạo bằng JS -->
      </div>
    </div>

    <script>
      const products = [
        {
          id: 1,
          name: "Asus ROG Zephyrus G14 GA402 14 inch 16GB 512GB",
          image: "../Images/Laptop/Asus/asus-rog-zephyrus-g14.jpg",
          installment: "Trả góp 0%",
          os: "Windows",
          cpu: "AMD Ryzen 9",
          ram: "16GB",
          storage: "SSD 512GB",
          screenSize: "13-14 inch",
          resolution: "2K",
          refreshRate: "144 Hz",
          gpu: "NVIDIA GeForce RTX",
          weight: "1.65 kg",
          purpose: "Gaming, Mỏng nhẹ - Di động",
          ports: "2 x USB-C, 2 x USB-A, 1 x HDMI, 1 x Jack 3.5mm",
          battery: "Lên đến 10 giờ",
          storages: [
            { capacity: "512GB", priceOld: 38990000, discountPercent: 18 },
            { capacity: "1TB", priceOld: 42990000, discountPercent: 15 },
          ],
          link: "../Chi tiết sản phẩm/Laptop/ASUS ROG Zephyrus G14 (2025).html"
        },
        {
          id: 2,
          name: "Asus Vivobook 15 X1504 15.6 inch 8GB 512GB",
          image: "../Images/Laptop/Asus/asus-vivobook-15-x1504.jpg",
          installment: "Trả góp 0%",
          os: "Windows",
          cpu: "Intel Core i5",
          ram: "8GB",
          storage: "SSD 512GB",
          screenSize: "15-16 inch",
          resolution: "Full HD",
          refreshRate: "60 Hz",
          gpu: "Intel Iris Xe",
          weight: "1.7 kg",
          purpose: "Học tập - Văn phòng",
          ports: "1 x USB-C, 2 x USB-A, 1 x HDMI, 1 x Jack 3.5mm",
          battery: "Lên đến 8 giờ",
          storages: [
            { capacity: "512GB", priceOld: 15990000, discountPercent: 12 },
          ],
        },
        {
          id: 3,
          name: "Asus TUF Gaming F15 15.6 inch 16GB 512GB",
          image: "../Images/Laptop/Asus/asus-tuf-gaming-f15.jpg",
          installment: "Trả góp 0%",
          os: "Windows",
          cpu: "Intel Core i7",
          ram: "16GB",
          storage: "SSD 512GB",
          screenSize: "15-16 inch",
          resolution: "Full HD",
          refreshRate: "144 Hz",
          gpu: "NVIDIA GeForce RTX",
          weight: "2.2 kg",
          purpose: "Gaming",
          ports: "1 x USB-C, 3 x USB-A, 1 x HDMI, 1 x LAN, 1 x Jack 3.5mm",
          battery: "Lên đến 6 giờ",
          storages: [
            { capacity: "512GB", priceOld: 28990000, discountPercent: 14 },
            { capacity: "1TB", priceOld: 31990000, discountPercent: 12 },
          ],
        },
        {
          id: 4,
          name: "Asus Zenbook 14 OLED UX3405 14 inch 16GB 512GB",
          image: "../Images/Laptop/Asus/asus-zenbook-14-oled.jpg",
          installment: "Trả góp 0%",
          os: "Windows",
          cpu: "Intel Core i7",
          ram: "16GB",
          storage: "SSD 512GB",
          screenSize: "13-14 inch",
          resolution: "2K",
          refreshRate: "90 Hz",
          gpu: "Intel Iris Xe",
          weight: "1.2 kg",
          purpose: "Mỏng nhẹ - Di động, Đồ họa - Kỹ thuật",
          ports: "2 x USB-C, 1 x USB-A, 1 x HDMI, 1 x Jack 3.5mm",
          battery: "Lên đến 12 giờ",
          storages: [
            { capacity: "512GB", priceOld: 32990000, discountPercent: 15 },
            { capacity: "1TB", priceOld: 35990000, discountPercent: 10 },
          ],
        },
        {
          id: 5,
          name: "Asus ProArt Studiobook 16 OLED 16 inch 32GB 1TB",
          image: "../Images/Laptop/Asus/asus-proart-studiobook-16.jpg",
          installment: "Trả góp 0%",
          os: "Windows",
          cpu: "Intel Core i9",
          ram: "32GB",
          storage: "SSD 1TB",
          screenSize: "15-16 inch",
          resolution: "4K",
          refreshRate: "60 Hz",
          gpu: "NVIDIA GeForce RTX",
          weight: "2.4 kg",
          purpose: "Đồ họa - Kỹ thuật",
          ports:
            "2 x USB-C, 2 x USB-A, 1 x HDMI, 1 x LAN, 1 x Jack 3.5mm, SD Card",
          battery: "Lên đến 8 giờ",
          storages: [
            { capacity: "1TB", priceOld: 62990000, discountPercent: 12 },
            { capacity: "2TB", priceOld: 68990000, discountPercent: 10 },
          ],
        },
        {
          id: 6,
          name: "Asus Vivobook Go 14 E1404 14 inch 8GB 256GB",
          image: "../Images/Laptop/Asus/asus-vivobook-go-14.jpg",
          installment: "Trả góp 0%",
          os: "Windows",
          cpu: "AMD Ryzen 5",
          ram: "8GB",
          storage: "SSD 256GB",
          screenSize: "13-14 inch",
          resolution: "Full HD",
          refreshRate: "60 Hz",
          gpu: "AMD Radeon",
          weight: "1.38 kg",
          purpose: "Học tập - Văn phòng",
          ports: "1 x USB-C, 2 x USB-A, 1 x HDMI, 1 x Jack 3.5mm",
          battery: "Lên đến 10 giờ",
          storages: [
            { capacity: "256GB", priceOld: 12990000, discountPercent: 16 },
            { capacity: "512GB", priceOld: 14990000, discountPercent: 14 },
          ],
        },
      ];

      function calcPriceNew(priceOld, discountPercent) {
        return priceOld * (1 - discountPercent / 100);
      }

      function formatPrice(price) {
        return price.toLocaleString("vi-VN") + " ₫";
      }

      function showToast(productName) {
              
          const toast = document.getElementById('toast'); // Lấy phần tử thông báo
          toast.textContent = `Đã thêm "${productName}" vào giỏ!`; // Thêm tên sản phẩm vào thông báo
          toast.style.visibility = 'visible'; // Hiển thị thông báo
          toast.style.opacity = '1'; // Đảm bảo thông báo có thể nhìn thấy
          
          setTimeout(() => {
              toast.style.opacity = '0'; // Từ từ ẩn thông báo
              setTimeout(() => {
                  toast.style.visibility = 'hidden'; // Ẩn hoàn toàn sau khi chuyển opacity về 0
              }, 500);
          }, 2000); // Hiển thị trong 2 giây
      }
    // Gán sự kiện click cho các nút "Thêm vào giỏ hàng"
    function addToCart() {
    const addCartButtons = document.querySelectorAll('.add-cart');
    addCartButtons.forEach(button => {
        button.addEventListener('click', (event) => {
            // Ngăn hành động mặc định của thẻ <a> (chuyển trang)
            event.preventDefault(); 
            // Ngăn sự kiện click lan ra thẻ <a> cha
            event.stopPropagation(); 

            const productName = event.target.closest('.product-card').querySelector('h5').textContent; // Lấy tên sản phẩm
            showToast(productName); // Gọi hàm hiển thị thông báo
        });
    });
}
          function displayProducts(list) {
            const productList = document.getElementById("product-list");
            productList.innerHTML = "";

            if (list.length === 0) {
              productList.innerHTML =
                "<div class='col-12 text-center my-5'><h3>Không tìm thấy sản phẩm nào phù hợp</h3></div>";
              return;
            }

            list.forEach((product) => {
              const col = document.createElement("div");
              col.className = "col-md-3 mb-4";

              const defaultStorage = product.storages[0];
              const priceNew = calcPriceNew(
                defaultStorage.priceOld,
                defaultStorage.discountPercent
              );

              // Tạo các nút cho dung lượng ổ cứng
              const storageOptions = product.storages
                .map(
                  (storage, idx) => `
          <button type="button" class="btn btn-outline-secondary ${
            idx === 0 ? "active" : ""
          }" data-index="${idx}">
              ${storage.capacity}
          </button>
        `
                )
                .join("");

              const baseName = product.name
                .replace(/\s+\d+(GB|TB)$/, "")
                .trim();

              col.innerHTML = `
              <a href="${product.link || '#'}" class="product-link">
          <div class="product-card d-flex flex-column">
              <img src="${product.image}" alt="${product.name}" />
              <h5 data-basename="${baseName}">${product.name}</h5>
              <p>${product.installment}</p>
              <div class="specs">
                  <span><i class="fas fa-microchip"></i> ${product.cpu}</span>
                  <span><i class="fas fa-memory"></i> ${product.ram}</span>
                  <span><i class="fas fa-hdd"></i> ${product.storage}</span>
                  <span><i class="fas fa-desktop"></i> ${
                    product.screenSize
                  }</span>
              </div>
              <div>
                  <span class="price-old">${formatPrice(
                    defaultStorage.priceOld
                  )}</span>
                  <span class="discount">-${
                    defaultStorage.discountPercent
                  }%</span>
              </div>
              <h4 id="product-price-${product.id}">${formatPrice(priceNew)}</h4>

              <div class="storage-options d-flex flex-wrap gap-2 mb-3" role="group" aria-label="Storage options">
                  ${storageOptions}
              </div>

              <button class="add-cart btn btn-danger mt-auto">Thêm vào giỏ hàng</button>
          </div>
        `;

              productList.appendChild(col);

              // Gán sự kiện click cho các nút dung lượng
              const btnGroup = col.querySelector("div[role='group']");
              btnGroup.querySelectorAll("button").forEach((button) => {
                button.addEventListener("click", (e) => {
                  const idx = parseInt(e.target.dataset.index);
                  const storage = product.storages[idx];
                  const newPrice = calcPriceNew(
                    storage.priceOld,
                    storage.discountPercent
                  );

                  const priceOldElem = col.querySelector(".price-old");
                  const discountElem = col.querySelector(".discount");
                  const priceNewElem = document.getElementById(
                    `product-price-${product.id}`
                  );

                  priceOldElem.textContent = formatPrice(storage.priceOld);
                  discountElem.textContent = `-${storage.discountPercent}%`;
                  priceNewElem.textContent = formatPrice(newPrice);

                  const nameElem = col.querySelector("h5");
                  const baseName = nameElem.getAttribute("data-basename");
                  nameElem.textContent = `${baseName} ${storage.capacity}`;

                  btnGroup
                    .querySelectorAll("button")
                    .forEach((btn) => btn.classList.remove("active"));
                  e.target.classList.add("active");
                });
              });

              // Gán sự kiện click cho nút thêm vào giỏ hàng
              addToCart();
            });
          }

      // Lấy thẻ form lọc
      const filterForm = document.querySelector("form");

      // Bắt sự kiện submit form (hoặc click nút)
      filterForm.addEventListener("submit", (e) => {
        e.preventDefault(); // ngăn submit reload trang

        // Lấy giá trị từng select
        const priceValue = document.getElementById("priceSelect").value;
        const osValue = document.getElementById("osSelect").value;
        const cpuValue = document.getElementById("cpuSelect").value;
        const ramValue = document.getElementById("ramSelect").value;
        const storageValue = document.getElementById("storageSelect").value;
        const gpuValue = document.getElementById("gpuSelect").value;
        const screenSizeValue =
          document.getElementById("screenSizeSelect").value;
        const resolutionValue =
          document.getElementById("resolutionSelect").value;
        const refreshRateValue =
          document.getElementById("refreshRateSelect").value;
        const purposeValue = document.getElementById("purposeSelect").value;

        // Hàm tính giá sau khi giảm
        const calculateDiscountPrice = (priceOld, discountPercent) => {
          return priceOld * (1 - discountPercent / 100);
        };

        // Lọc các sản phẩm theo điều kiện
        let filteredProducts = products.filter((product) => {
          let priceMatch = true;

          if (priceValue !== "Chọn mức giá") {
            const priceRanges = {
              "Dưới 10 triệu": [0, 10000000],
              "Từ 10 - 15 triệu": [10000000, 15000000],
              "Từ 15 - 20 triệu": [15000000, 20000000],
              "Từ 20 - 25 triệu": [20000000, 25000000],
              "Từ 25 - 35 triệu": [25000000, 35000000],
              "Từ 35 - 50 triệu": [35000000, 50000000],
              "Trên 50 triệu": [50000000, Infinity],
            };

            // Lọc theo giá cụ thể (theo khoảng giá)
            if (
              priceRanges[priceValue] &&
              Array.isArray(priceRanges[priceValue])
            ) {
              const [minPrice, maxPrice] = priceRanges[priceValue];
              priceMatch = product.storages.some((storage) => {
                const discountedPrice = calculateDiscountPrice(
                  storage.priceOld,
                  storage.discountPercent
                );
                return (
                  discountedPrice >= minPrice && discountedPrice <= maxPrice
                );
              });
            }
          }

          // Lọc theo các tiêu chí khác
          const osMatch =
            osValue === "Chọn hệ điều hành" || product.os === osValue;
          const cpuMatch =
            cpuValue === "Chọn CPU" || product.cpu.includes(cpuValue);
          const ramMatch = ramValue === "Chọn RAM" || product.ram === ramValue;
          const storageMatch =
            storageValue === "Chọn ổ cứng" || product.storage === storageValue;
          const gpuMatch =
            gpuValue === "Chọn card đồ họa" || product.gpu.includes(gpuValue);
          const screenSizeMatch =
            screenSizeValue === "Chọn kích thước" ||
            product.screenSize === screenSizeValue;
          const resolutionMatch =
            resolutionValue === "Chọn độ phân giải" ||
            product.resolution === resolutionValue;
          const refreshRateMatch =
            refreshRateValue === "Chọn tần số quét" ||
            product.refreshRate === refreshRateValue;
          const purposeMatch =
            purposeValue === "Chọn mục đích" ||
            product.purpose.includes(purposeValue);

          return (
            priceMatch &&
            osMatch &&
            cpuMatch &&
            ramMatch &&
            storageMatch &&
            gpuMatch &&
            screenSizeMatch &&
            resolutionMatch &&
            refreshRateMatch &&
            purposeMatch
          );
        });

        // Sắp xếp lại sản phẩm theo giá tăng dần hoặc giảm dần
        if (priceValue === "Giá tăng dần" || priceValue === "Giá giảm dần") {
          filteredProducts = filteredProducts.sort((a, b) => {
            const priceA = calculateDiscountPrice(
              a.storages[0].priceOld,
              a.storages[0].discountPercent
            );
            const priceB = calculateDiscountPrice(
              b.storages[0].priceOld,
              b.storages[0].discountPercent
            );
            return priceValue === "Giá tăng dần"
              ? priceA - priceB
              : priceB - priceA;
          });
        }

        // Hiển thị sản phẩm đã lọc
        displayProducts(filteredProducts);
      });

      // Hiển thị tất cả sản phẩm khi trang vừa load
      displayProducts(products);
    </script>
    <div
      id="toast"
      style="
        visibility: hidden;
        min-width: 250px;
        background-color: #4caf50;
        color: white;
        text-align: center;
        border-radius: 8px;
        padding: 16px;
        position: fixed;
        z-index: 1000;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        font-size: 17px;
        opacity: 0;
        transition: opacity 0.5s ease-in-out;
      "
    ></div>

    <div id="footer"></div>
    <script>
      fetch("../footer.html")
        .then((res) => res.text())
        .then((data) => (document.getElementById("footer").innerHTML = data));
    </script>
    <script>
      fetch("../header.html")
        .then((res) => res.text())
        .then((data) => (document.getElementById("header").innerHTML = data));
    </script>
  </body>
</html>
